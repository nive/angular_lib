// (c) 2013-2016 Nive GmbH - nive.io
// 
// nive-angular v0.9.0
// 
// License: Released under MIT-License. See http://jquery.org/license
// Docs: http://www.nive.co/docs/webapi
//
angular.module("nive.resource",[]),angular.module("nive.services",["nive.resource"]),angular.module("nive",["nive.services"]),window.nive=window.nive||{},nive.endpoint=nive.endpoint||{},function(){"use strict";nive.endpoint.makeUrl=function(t,i){t=t||{};var n=".nive.io",s="https";0==t.secure?s="http:":s.indexOf(":")!=s.length-1&&(s+=":");var e=t.domain||"";e&&(e=-1==e.indexOf(".")?e+n:e);var o=t.version||"api",r=t.method,u=i;if(u||t.path){if(u?t.path&&0==!u.indexOf("/")&&(t.path.lastIndexOf("/")!=u.length-1&&(u="/"+u),u=t.path+u):u=t.path,0==u.indexOf("./")||0==u.indexOf("../"))return r?(u.lastIndexOf("/")!=u.length-1&&(u+="/"),u+r):u;0==u.indexOf("/")&&(u=u.substr(1,u.length)),u.lastIndexOf("/")==u.length-1&&(u=u.substr(0,u.length-1))}if(!t.service)throw"Invalid service name";var p=t.service||"",a="";return e&&(a=s+"//"+e),a+="/"+p,o&&(a+="/"+o),u&&(a+="/"+u),r&&(a+="/"+r),a},nive.endpoint.EndpointException=function(t){this.message=t,this.name="EndpointException"}}(),function(){"use strict";angular.module("nive.resource").provider("NiveAPI",function(){var t,i=function(t){return t.data},n=function(i){return angular.isObject(i.data)&&i.data.message?t.reject(i.data.message):t.reject("NiveAPI: An unknown error occurred.")};this.successHandler=function(t){return angular.isFunction(t)&&(i=t),i},this.errorHandler=function(t){return angular.isFunction(t)&&(n=t),n},this.$get=["$http","$q",function(s,e){return t=e,{get:function(t,i,n,s){return this.call(t,i,n,"GET",s)},post:function(t,i,n,s){return this.call(t,i,n,"POST",s)},call:function(t,e,o,r,u){r=angular.isString(r)?r:"GET";var p=nive.endpoint.makeUrl(angular.extend({},{service:t,method:e},u||{})),a={};u.token&&(a["x-auth-token"]=u.token);var c=s({method:r,url:p,data:o,params:"GET"===r?o:"",responseType:"json",headers:a});return c.then(i,n)}}}]})}(),function(){"use strict";angular.module("nive.services").factory("NiveKvStoreFactory",["NiveAPI",function(t){var i={},n=function(t){this.options(t)};return n.factory=function(t){return new n(angular.isString(t)?{service:t}:t)},n.prototype={options:function(t,n){switch(!0){case angular.isString(t):if(!angular.isDefined(n))return i[t];i[t]=n;break;case angular.isObject(t):angular.extend(i,t)}return i},getItem:function(i){return angular.isString(i)&&(i={key:i}),t.post(this.options("service"),"getItem",i,this.options())},newItem:function(i){return angular.isArray(i)&&(i={items:i}),t.post(this.options("service"),"newItem",i,this.options())},setItem:function(i){return angular.isArray(i)&&(i={items:i}),t.post(this.options("service"),"setItem",i,this.options())},removeItem:function(i){return angular.isString(i)&&(i={key:i}),t.post(this.options("service"),"removeItem",i,this.options())},list:function(i){return t.post(this.options("service"),"list",i,this.options())},keys:function(i){return t.post(this.options("service"),"keys",i,this.options())},allowed:function(i){return t.post(this.options("service"),"allowed",i,this.options())},getPermissions:function(i){return t.post(this.options("service"),"getPermissions",i,this.options())},setPermissions:function(i){return t.post(this.options("service"),"setPermissions",i,this.options())},getOwner:function(i){return t.post(this.options("service"),"getOwner",i,this.options())},setOwner:function(i){return t.post(this.options("service"),"setOwner",i,this.options())},ping:function(i){return t.post(this.options("service"),"ping",i,this.options())}},n.factory}])}(),function(){"use strict";angular.module("nive.services").factory("NiveFileStoreFactory",["NiveAPI",function(t){var i={},n=function(t){this.options(t)};return n.factory=function(t){return new n(angular.isString(t)?{service:t}:t)},n.prototype={options:function(t,n){switch(!0){case angular.isString(t):if(!angular.isDefined(n))return i[t];i[t]=n;break;case angular.isObject(t):angular.extend(i,t)}return i},getItem:function(i){var n=null;return angular.isString(i)?(n=i,i={}):(n=i.path,i={}),t.post(this.options("service"),"@getItem",i,this.options(),n)},newItem:function(i){var n=null;if(i&&i.name&&!i.path){var s=i.name.lastIndexOf("/");s>-1&&(n=i.name.substr(s+1),i.name=i.name.substr(0,s))}else i.path&&(n=i.path,i.path=null);return t.post(this.options("service"),"@newItem",i,this.options(),n)},setItem:function(i){var n=null;return i&&i.path&&(n=i.path,i.path=null),t.post(this.options("service"),"@setItem",i,this.options(),n)},removeItem:function(i){var n=null;return i&&i.path&&(n=i.path,i.path=null),t.post(this.options("service"),"@removeItem",i,this.options(),n)},read:function(i){var n=null;return angular.isString(i)?(n=i,i={}):(n=i.path,i={}),t.post(this.options("service"),"@read",i,this.options(),n)},write:function(i){var n=null;return i&&i.path&&(n=i.path,i.path=null),t.post(this.options("service"),"@write",i,this.options(),n)},move:function(i){var n=null;return i&&i.path&&(n=i.path,i.path=null),t.post(this.options("service"),"@move",i,this.options(),n)},list:function(i){i=i||{};var n=null;return i&&i.path&&(n=i.path,i.path=null),t.post(this.options("service"),"@list",i,this.options(),n)},allowed:function(i){var n=null;return i&&i.path&&(n=i.path,i.path=null),t.post(this.options("service"),"@allowed",i,this.options(),n)},getPermissions:function(i){var n=null;return angular.isString(i)?(n=i,i={}):(n=i.path,i={}),t.post(this.options("service"),"@getPermissions",i,this.options(),n)},setPermissions:function(i){var n=null;return i&&i.path&&(n=i.path,i.path=null),t.post(this.options("service"),"@setPermissions",i,this.options(),n)},getOwner:function(i){var n=null;return angular.isString(i)?(n=i,i={}):(n=i.path,i={}),t.post(this.options("service"),"@getOwner",i,this.options(),n)},setOwner:function(i){var n=null;return i&&i.path&&(n=i.path,i.path=null),t.post(this.options("service"),"@setOwner",i,this.options(),n)},ping:function(i){var n="/";return t.post(this.options("service"),"@setOwner",i,this.options(),n)}},n.factory}])}(),function(){"use strict";angular.module("nive.services").factory("NiveUserFactory",["NiveAPI",function(t){var i={service:"users",token:null},n=function(t){this.options(t)};return n.factory=function(t){return new n(t)},n.prototype={options:function(t,n){switch(!0){case angular.isString(t):if(!angular.isDefined(n))return i[t];i[t]=n;break;case angular.isObject(t):angular.extend(i,t)}return i},token:function(i){var n=t.post(this.options("service"),"token",i,this.options());return n.token&&this.options("token",n.token),n},signin:function(i){return t.post(this.options("service"),"signin",i,this.options())},signout:function(){var i=t.get(this.options("service"),"signout",null,this.options());return this.options("token")&&this.options("token",null),i},identity:function(){return t.get(this.options("service"),"identity",null,this.options())},name:function(){return t.get(this.options("service"),"name",null,this.options())},profile:function(){return t.get(this.options("service"),"profile",null,this.options())},authenticated:function(i){return angular.isArray(i)?i={groups:i}:angular.isString(i)&&(i={groups:[i]}),t.post(this.options("service"),"authenticated",i,this.options())},signupDirect:function(i){return t.post(this.options("service"),"signupDirect",i,this.options())},signupOptin:function(i){return t.post(this.options("service"),"signupOptin",i,this.options())},signupReview:function(i){return t.post(this.options("service"),"signupReview",i,this.options())},signupSendpw:function(i){return t.post(this.options("service"),"signupSendpw",i,this.options())},signupUid:function(i){return t.post(this.options("service"),"signupUid",i,this.options())},activate:function(i){return angular.isString(i)&&(i={token:i}),t.post(this.options("service"),"activate",i,this.options())},update:function(i){return t.post(this.options("service"),"update",i,this.options())},updatePassword:function(i){return t.post(this.options("service"),"updatePassword",i,this.options())},updateEmail:function(i){return angular.isString(i)&&(i={email:i}),t.post(this.options("service"),"updateEmail",i,this.options())},verifyEmail:function(i){return angular.isString(i)&&(i={email:i}),t.post(this.options("service"),"verifyEmail",i,this.options())},verifyEmail2:function(i){return angular.isString(i)&&(i={token:i}),t.post(this.options("service"),"verifyEmail2",i,this.options())},resetPassword:function(i){return angular.isString()&&(i={identity:i}),t.post(this.options("service"),"resetPassword",i,this.options())},resetPassword2:function(i){return t.post(this.options("service"),"resetPassword2",i,this.options())},message:function(i){return t.post(this.options("service"),"message",i,this.options())},disable:function(i){return t.post(this.options("service"),"disable",i,this.options())},"delete":function(i){return t.post(this.options("service"),"delete",i,this.options())},review:function(i){return t.post(this.options("service"),"review",i,this.options())},list:function(i){return t.post(this.options("service"),"list",i,this.options())},identities:function(i){return t.post(this.options("service"),"identities",i,this.options())},getUser:function(i){return angular.isString(i)&&(i={identity:i}),t.post(this.options("service"),"getUser",i,this.options())},setUser:function(i){return t.post(this.options("service"),"setUser",i,this.options())},removeUser:function(i){return angular.isString(i)&&(i={identity:i}),t.post(this.options("service"),"removeUser",i,this.options())},allowed:function(i){return t.post(this.options("service"),"allowed",i,this.options())},getPermissions:function(i){return t.post(this.options("service"),"getPermissions",i,this.options())},setPermissions:function(i){return t.post(this.options("service"),"setPermissions",i,this.options())},ping:function(i){return t.post(this.options("service"),"ping",i,this.options())}},n.factory}])}();