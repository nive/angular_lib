// (c) 2013-2016 Nive GmbH - nive.io
// 
// nive-angular v0.8.3
// 
// License: Released under MIT-License. See http://jquery.org/license
// Docs: http://www.nive.co/docs/webapi
//
angular.module("nive.resource",[]),angular.module("nive.services",["nive.resource"]),angular.module("nive",["nive.services"]),window.nive=window.nive||{},nive.endpoint=nive.endpoint||{},function(){"use strict";nive.endpoint.makeUrl=function(t,n){t=t||{};var i=".nive.io",e="https";0==t.secure?e="http:":e.indexOf(":")!=e.length-1&&(e+=":");var s=t.domain||"";s&&(s=-1==s.indexOf(".")?s+i:s);var o=t.version||"api",r=t.method,u=n;if(u||t.path){if(u?t.path&&0==!u.indexOf("/")&&(t.path.lastIndexOf("/")!=u.length-1&&(u="/"+u),u=t.path+u):u=t.path,0==u.indexOf("./")||0==u.indexOf("../"))return r?(u.lastIndexOf("/")!=u.length-1&&(u+="/"),u+r):u;0==u.indexOf("/")&&(u=u.substr(1,u.length)),u.lastIndexOf("/")==u.length-1&&(u=u.substr(0,u.length-1))}if(!t.service)throw"Invalid service name";var a=t.service||"",p="";return s&&(p=e+"//"+s),p+="/"+a,o&&(p+="/"+o),u&&(p+="/"+u),r&&(p+="/"+r),p},nive.endpoint.EndpointException=function(t){this.message=t,this.name="EndpointException"}}(),function(){"use strict";angular.module("nive.resource").provider("NiveAPI",function(){var t,n=function(t){return t.data},i=function(n){return angular.isObject(n.data)&&n.data.message?t.reject(n.data.message):t.reject("NiveAPI: An unknown error occurred.")};this.successHandler=function(t){return angular.isFunction(t)&&(n=t),n},this.errorHandler=function(t){return angular.isFunction(t)&&(i=t),i},this.$get=["$http","$q",function(e,s){return t=s,{get:function(t,n,i,e){return this.call(t,n,i,"GET",e)},post:function(t,n,i,e){return this.call(t,n,i,"POST",e)},call:function(t,s,o,r,u){r=angular.isString(r)?r:"GET";var a=nive.endpoint.makeUrl(angular.extend({},{service:t,method:s},u||{})),p={};u.token&&(p["x-auth-token"]=u.token);var c=e({method:r,url:a,data:o,params:"GET"===r?o:"",responseType:"json",headers:p});return c.then(n,i)}}}]})}(),function(){"use strict";angular.module("nive.services").factory("NiveFileStoreFactory",["NiveAPI",function(t){var n={},i=function(t){this.options(t)};return i.factory=function(t){return new i(angular.isString(t)?{service:t}:t)},i.prototype={options:function(t,i){switch(!0){case angular.isString(t):if(!angular.isDefined(i))return n[t];n[t]=i;break;case angular.isObject(t):angular.extend(n,t)}return n},getItem:function(n){var i=null;return angular.isString(n)?(i=n,n={}):(i=n.path,n={}),t.post(this.options("service"),"@getItem",n,this.options(),i)},newItem:function(n){var i=null;if(n&&n.name&&!n.path){var e=n.name.lastIndexOf("/");e>-1&&(i=n.name.substr(e+1),n.name=n.name.substr(0,e))}else n.path&&(i=n.path,n.path=null);return t.post(this.options("service"),"@newItem",n,this.options(),i)},setItem:function(n){var i=null;return n&&n.path&&(i=n.path,n.path=null),t.post(this.options("service"),"@setItem",n,this.options(),i)},removeItem:function(n){var i=null;return n&&n.path&&(i=n.path,n.path=null),t.post(this.options("service"),"@removeItem",n,this.options(),i)},read:function(n){var i=null;return angular.isString(n)?(i=n,n={}):(i=n.path,n={}),t.post(this.options("service"),"@read",n,this.options(),i)},write:function(n){var i=null;return n&&n.path&&(i=n.path,n.path=null),t.post(this.options("service"),"@write",n,this.options(),i)},move:function(n){var i=null;return n&&n.path&&(i=n.path,n.path=null),t.post(this.options("service"),"@move",n,this.options(),i)},list:function(n){n=n||{};var i=null;return n&&n.path&&(i=n.path,n.path=null),t.post(this.options("service"),"@list",n,this.options(),i)},allowed:function(n){var i=null;return n&&n.path&&(i=n.path,n.path=null),t.post(this.options("service"),"@allowed",n,this.options(),i)},getPermissions:function(n){var i=null;return angular.isString(n)?(i=n,n={}):(i=n.path,n={}),t.post(this.options("service"),"@getPermissions",n,this.options(),i)},setPermissions:function(n){var i=null;return n&&n.path&&(i=n.path,n.path=null),t.post(this.options("service"),"@setPermissions",n,this.options(),i)},getOwner:function(n){var i=null;return angular.isString(n)?(i=n,n={}):(i=n.path,n={}),t.post(this.options("service"),"@getOwner",n,this.options(),i)},setOwner:function(n){var i=null;return n&&n.path&&(i=n.path,n.path=null),t.post(this.options("service"),"@setOwner",n,this.options(),i)},ping:function(n){var i="/";return t.post(this.options("service"),"@setOwner",n,this.options(),i)}},i.factory}])}(),function(){"use strict";angular.module("nive.services").factory("NiveKvStoreFactory",["NiveAPI",function(t){var n={},i=function(t){this.options(t)};return i.factory=function(t){return new i(angular.isString(t)?{service:t}:t)},i.prototype={options:function(t,i){switch(!0){case angular.isString(t):if(!angular.isDefined(i))return n[t];n[t]=i;break;case angular.isObject(t):angular.extend(n,t)}return n},getItem:function(n){return angular.isString(n)&&(n={key:n}),t.post(this.options("service"),"getItem",n,this.options())},newItem:function(n){return angular.isArray(n)&&(n={items:n}),t.post(this.options("service"),"newItem",n,this.options())},setItem:function(n){return angular.isArray(n)&&(n={items:n}),t.post(this.options("service"),"setItem",n,this.options())},removeItem:function(n){return angular.isString(n)&&(n={key:n}),t.post(this.options("service"),"removeItem",n,this.options())},list:function(n){return t.post(this.options("service"),"list",n,this.options())},keys:function(n){return t.post(this.options("service"),"keys",n,this.options())}},i.factory}])}(),function(){"use strict";angular.module("nive.services").factory("NiveUserFactory",["NiveAPI",function(t){var n={service:"users",token:null},i=function(t){this.options(t)};return i.factory=function(t){return new i(t)},i.prototype={options:function(t,i){switch(!0){case angular.isString(t):if(!angular.isDefined(i))return n[t];n[t]=i;break;case angular.isObject(t):angular.extend(n,t)}return n},token:function(n){var i=t.post(this.options("service"),"token",n,this.options());return i.token&&this.options("token",i.token),i},signin:function(n){return t.post(this.options("service"),"signin",n,this.options())},signout:function(){var n=t.get(this.options("service"),"signout",null,this.options());return this.options("token")&&this.options("token",null),n},identity:function(){return t.get(this.options("service"),"identity",null,this.options())},name:function(){return t.get(this.options("service"),"name",null,this.options())},profile:function(){return t.get(this.options("service"),"profile",null,this.options())},authenticated:function(n){return angular.isArray(n)?n={groups:n}:angular.isString(n)&&(n={groups:[n]}),t.post(this.options("service"),"authenticated",n,this.options())},update:function(n){return t.post(this.options("service"),"update",n,this.options())},updatePassword:function(n){return t.post(this.options("service"),"updatePassword",n,this.options())},updateEmail:function(n){return angular.isString(n)&&(n={email:n}),t.post(this.options("service"),"updateEmail",n,this.options())},verifyEmail:function(n){return angular.isString(n)&&(n={email:n}),t.post(this.options("service"),"verifyEmail",n,this.options())},verifyEmail2:function(n){return angular.isString(n)&&(n={token:n}),t.post(this.options("service"),"verifyEmail2",n,this.options())},resetPassword:function(n){return angular.isString()&&(n={identity:n}),t.post(this.options("service"),"resetPassword",n,this.options())},resetPassword2:function(n){return t.post(this.options("service"),"resetPassword2",n,this.options())},message:function(n){return t.post(this.options("service"),"message",n,this.options())},disable:function(n){return t.post(this.options("service"),"disable",n,this.options())},"delete":function(n){return t.post(this.options("service"),"delete",n,this.options())},signupDirect:function(n){return t.post(this.options("service"),"signupDirect",n,this.options())},signupOptin:function(n){return t.post(this.options("service"),"signupOptin",n,this.options())},signupReview:function(n){return t.post(this.options("service"),"signupReview",n,this.options())},signupSendpw:function(n){return t.post(this.options("service"),"signupSendpw",n,this.options())},signupUid:function(n){return t.post(this.options("service"),"signupUid",n,this.options())},signupConfirm:function(n){return angular.isString(n)&&(n={token:n}),t.post(this.options("service"),"signupConfirm",n,this.options())},review:function(n){return t.post(this.options("service"),"review",n,this.options())},getUser:function(n){return angular.isString(n)&&(n={identity:n}),t.post(this.options("service"),"getUser",n,this.options())},setUser:function(n){return t.post(this.options("service"),"setUser",n,this.options())},removeUser:function(n){return angular.isString(n)&&(n={identity:n}),t.post(this.options("service"),"removeUser",n,this.options())},list:function(n){return t.post(this.options("service"),"list",n,this.options())}},i.factory}])}();